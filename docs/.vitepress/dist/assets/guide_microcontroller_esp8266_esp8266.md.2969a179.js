import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.dd5a1521.js";const C=JSON.parse('{"title":"ESP8266","description":"","frontmatter":{"title":"ESP8266","date":"2022-05-22T08:40:27.000Z"},"headers":[],"relativePath":"guide/microcontroller/esp8266/esp8266.md","filePath":"guide/microcontroller/esp8266/esp8266.md"}'),p={name:"guide/microcontroller/esp8266/esp8266.md"},o=l(`<h5 id="_1-建立网络连接" tabindex="-1">1.建立网络连接 <a class="header-anchor" href="#_1-建立网络连接" aria-label="Permalink to &quot;1.建立网络连接&quot;">​</a></h5><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WiFi.h&gt;</span><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//引入库函数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> ssidIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ChinaNet-aemM&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> passwordIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;wp907678446&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> ssidOut </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ESP8266&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">    //定义用户名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> passwordOut </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;12345678&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">   //定义密码</span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  	Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;">         //启动串口通讯</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFi.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(ssidIn, passwordIn);</span><span style="color:#6A737D;">   //连接网络    </span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFi.</span><span style="color:#B392F0;">softAP</span><span style="color:#E1E4E8;">(ssidOut, passwordOut);</span><span style="color:#6A737D;">  //NodeMCU的AP模式(开放网络)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;                             </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;等待网络连接&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);                  </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;连接到的网络为:&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(WiFi.</span><span style="color:#B392F0;">SSID</span><span style="color:#E1E4E8;">()); </span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;分配的ip为:&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(WiFi.</span><span style="color:#B392F0;">localIP</span><span style="color:#E1E4E8;">()); </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WiFi.h&gt;</span><span style="color:#24292E;">        </span><span style="color:#6A737D;">//引入库函数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> ssidIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ChinaNet-aemM&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> passwordIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;wp907678446&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> ssidOut </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ESP8266&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">    //定义用户名</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> passwordOut </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;12345678&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">   //定义密码</span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  	Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">         //启动串口通讯</span></span>
<span class="line"><span style="color:#24292E;">    WiFi.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(ssidIn, passwordIn);</span><span style="color:#6A737D;">   //连接网络    </span></span>
<span class="line"><span style="color:#24292E;">    WiFi.</span><span style="color:#6F42C1;">softAP</span><span style="color:#24292E;">(ssidOut, passwordOut);</span><span style="color:#6A737D;">  //NodeMCU的AP模式(开放网络)</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;                             </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;等待网络连接&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);                  </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;连接到的网络为:&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(WiFi.</span><span style="color:#6F42C1;">SSID</span><span style="color:#24292E;">()); </span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;分配的ip为:&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(WiFi.</span><span style="color:#6F42C1;">localIP</span><span style="color:#24292E;">()); </span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_2-json解析" tabindex="-1">2.JSON解析 <a class="header-anchor" href="#_2-json解析" aria-label="Permalink to &quot;2.JSON解析&quot;">​</a></h5><p><a href="https://arduinojson.org/v5/assistant/#/step2" target="_blank" rel="noreferrer">自动生成工具</a></p><h6 id="解析" tabindex="-1">解析 <a class="header-anchor" href="#解析" aria-label="Permalink to &quot;解析&quot;">​</a></h6><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ArduinoJson.h&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//解析</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">size_t</span><span style="color:#E1E4E8;"> capacity </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">JSON_ARRAY_SIZE</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">JSON_OBJECT_SIZE</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">40</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    DynamicJsonBuffer </span><span style="color:#B392F0;">jsonBuffer</span><span style="color:#E1E4E8;">(capacity);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> json </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;[{</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">name</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">:</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">test</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">,</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">message</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">:</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">testMessage</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">}]&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    JsonArray</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> root </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> jsonBuffer.</span><span style="color:#B392F0;">parseArray</span><span style="color:#E1E4E8;">(json);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> root_0_name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">root</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">][</span><span style="color:#9ECBFF;">&quot;name&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;test&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> root_0_message </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">root</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">][</span><span style="color:#9ECBFF;">&quot;message&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;testMessage&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ArduinoJson.h&gt;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//解析</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">size_t</span><span style="color:#24292E;"> capacity </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">JSON_ARRAY_SIZE</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">JSON_OBJECT_SIZE</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">40</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    DynamicJsonBuffer </span><span style="color:#6F42C1;">jsonBuffer</span><span style="color:#24292E;">(capacity);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> json </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;[{</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">name</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">:</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">test</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">,</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">message</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">:</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">testMessage</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">}]&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    JsonArray</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> root </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> jsonBuffer.</span><span style="color:#6F42C1;">parseArray</span><span style="color:#24292E;">(json);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> root_0_name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">root</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">][</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;test&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> root_0_message </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">root</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">][</span><span style="color:#032F62;">&quot;message&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;testMessage&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {}</span></span></code></pre></div><h6 id="生成" tabindex="-1">生成 <a class="header-anchor" href="#生成" aria-label="Permalink to &quot;生成&quot;">​</a></h6><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ArduinoJson.h&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//生成</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">size_t</span><span style="color:#E1E4E8;"> capacity </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">JSON_ARRAY_SIZE</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">JSON_OBJECT_SIZE</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    DynamicJsonBuffer </span><span style="color:#B392F0;">jsonBuffer</span><span style="color:#E1E4E8;">(capacity);</span></span>
<span class="line"><span style="color:#E1E4E8;">    JsonArray</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> root </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> jsonBuffer.</span><span style="color:#B392F0;">createArray</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    JsonObject</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> root_0 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> root.</span><span style="color:#B392F0;">createNestedObject</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">root_0</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;name&quot;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;test&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">root_0</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;message&quot;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;testMessage&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    root.</span><span style="color:#B392F0;">printTo</span><span style="color:#E1E4E8;">(Serial);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ArduinoJson.h&gt;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//生成</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">size_t</span><span style="color:#24292E;"> capacity </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">JSON_ARRAY_SIZE</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">JSON_OBJECT_SIZE</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    DynamicJsonBuffer </span><span style="color:#6F42C1;">jsonBuffer</span><span style="color:#24292E;">(capacity);</span></span>
<span class="line"><span style="color:#24292E;">    JsonArray</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> root </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> jsonBuffer.</span><span style="color:#6F42C1;">createArray</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    JsonObject</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> root_0 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> root.</span><span style="color:#6F42C1;">createNestedObject</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">root_0</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;test&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">root_0</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;message&quot;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;testMessage&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    root.</span><span style="color:#6F42C1;">printTo</span><span style="color:#24292E;">(Serial);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {}</span></span></code></pre></div><h5 id="_3-网络请求" tabindex="-1">3.网络请求 <a class="header-anchor" href="#_3-网络请求" aria-label="Permalink to &quot;3.网络请求&quot;">​</a></h5><h6 id="服务端" tabindex="-1">服务端 <a class="header-anchor" href="#服务端" aria-label="Permalink to &quot;服务端&quot;">​</a></h6><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WiFi.h&gt;</span><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//引入wifi库函数</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WebServer.h&gt;</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;">//引入webserver库函数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> ssidIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ChinaNet-aemM&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> passwordIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;wp907678446&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> ssidOut </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ESP8266&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">    //定义用户名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> passwordOut </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;12345678&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">   //定义密码</span></span>
<span class="line"><span style="color:#E1E4E8;">ESP8266WebServer </span><span style="color:#B392F0;">esp8266_server</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">80</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> 	//设置服务器暴露端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">	Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;">         //启动串口通讯</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFi.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(ssidIn, passwordIn);</span><span style="color:#6A737D;">   //连接网络    </span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFi.</span><span style="color:#B392F0;">softAP</span><span style="color:#E1E4E8;">(ssidOut, passwordOut);</span><span style="color:#6A737D;">  //NodeMCU的AP模式(开放网络)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;                             </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;等待网络连接&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);                  </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;连接到的网络为:&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(WiFi.</span><span style="color:#B392F0;">SSID</span><span style="color:#E1E4E8;">()); </span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;分配的ip为:&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(WiFi.</span><span style="color:#B392F0;">localIP</span><span style="color:#E1E4E8;">()); </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> 						//启动服务器</span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;/&quot;</span><span style="color:#E1E4E8;">, handleRoot);</span><span style="color:#6A737D;">				//连接成功回调函数</span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">onNotFound</span><span style="color:#E1E4E8;">(handleNotFound);</span><span style="color:#6A737D;"> 		//连接失败回调函数</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">  esp8266_server.</span><span style="color:#B392F0;">handleClient</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;">     // 处理http服务器访问</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">handleRoot</span><span style="color:#E1E4E8;">() {</span><span style="color:#6A737D;"> //成功回调函数</span></span>
<span class="line"><span style="color:#E1E4E8;">  esp8266_server.</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">200</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;text/plain&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;hello word&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">handleNotFound</span><span style="color:#E1E4E8;">(){</span><span style="color:#6A737D;">	//失败回调函数</span></span>
<span class="line"><span style="color:#E1E4E8;">  esp8266_server.</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">404</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;text/plain&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;404: Not found&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WiFi.h&gt;</span><span style="color:#24292E;">        </span><span style="color:#6A737D;">//引入wifi库函数</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WebServer.h&gt;</span><span style="color:#24292E;">   </span><span style="color:#6A737D;">//引入webserver库函数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> ssidIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ChinaNet-aemM&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> passwordIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;wp907678446&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> ssidOut </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ESP8266&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">    //定义用户名</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> passwordOut </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;12345678&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">   //定义密码</span></span>
<span class="line"><span style="color:#24292E;">ESP8266WebServer </span><span style="color:#6F42C1;">esp8266_server</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">80</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> 	//设置服务器暴露端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">	Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">         //启动串口通讯</span></span>
<span class="line"><span style="color:#24292E;">    WiFi.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(ssidIn, passwordIn);</span><span style="color:#6A737D;">   //连接网络    </span></span>
<span class="line"><span style="color:#24292E;">    WiFi.</span><span style="color:#6F42C1;">softAP</span><span style="color:#24292E;">(ssidOut, passwordOut);</span><span style="color:#6A737D;">  //NodeMCU的AP模式(开放网络)</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;                             </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;等待网络连接&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);                  </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;连接到的网络为:&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(WiFi.</span><span style="color:#6F42C1;">SSID</span><span style="color:#24292E;">()); </span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;分配的ip为:&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(WiFi.</span><span style="color:#6F42C1;">localIP</span><span style="color:#24292E;">()); </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> 						//启动服务器</span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;/&quot;</span><span style="color:#24292E;">, handleRoot);</span><span style="color:#6A737D;">				//连接成功回调函数</span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">onNotFound</span><span style="color:#24292E;">(handleNotFound);</span><span style="color:#6A737D;"> 		//连接失败回调函数</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">  esp8266_server.</span><span style="color:#6F42C1;">handleClient</span><span style="color:#24292E;">();</span><span style="color:#6A737D;">     // 处理http服务器访问</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handleRoot</span><span style="color:#24292E;">() {</span><span style="color:#6A737D;"> //成功回调函数</span></span>
<span class="line"><span style="color:#24292E;">  esp8266_server.</span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">200</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;text/plain&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;hello word&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handleNotFound</span><span style="color:#24292E;">(){</span><span style="color:#6A737D;">	//失败回调函数</span></span>
<span class="line"><span style="color:#24292E;">  esp8266_server.</span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">404</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;text/plain&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;404: Not found&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WiFi.h&gt;</span><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//引入wifi库函数</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WebServer.h&gt;</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;">//引入webserver库函数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">buttonPin</span><span style="color:#E1E4E8;"> D3</span><span style="color:#6A737D;">            //引入按钮引脚D3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> ssidIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ChinaNet-aemM&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> passwordIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;wp907678446&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;"> pinState;</span><span style="color:#6A737D;">  //存储引脚状态用变量</span></span>
<span class="line"><span style="color:#E1E4E8;">ESP8266WebServer </span><span style="color:#B392F0;">esp8266_server</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">80</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> 	//设置服务器暴露端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">pinMode</span><span style="color:#E1E4E8;">(LED_BUILTIN, OUTPUT);</span><span style="color:#6A737D;"> //设置内置LED引脚为输出模式以便控制LED</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">	Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;">         //启动串口通讯</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFi.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(ssidIn, passwordIn);</span><span style="color:#6A737D;">   //连接网络</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;                             </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;等待网络连接&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);                  </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;连接到的网络为:&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(WiFi.</span><span style="color:#B392F0;">SSID</span><span style="color:#E1E4E8;">()); </span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;分配的ip为:&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(WiFi.</span><span style="color:#B392F0;">localIP</span><span style="color:#E1E4E8;">()); </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//启动服务器</span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//GET请求</span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;/&quot;</span><span style="color:#E1E4E8;">, HTTP_GET ,handleRoot);	</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//GET请求</span></span>
<span class="line"><span style="color:#E1E4E8;">	esp8266_server.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;/refresh&quot;</span><span style="color:#E1E4E8;">, HTTP_POST ,handrefresh);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建post请求</span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;/led&quot;</span><span style="color:#E1E4E8;">, HTTP_POST, handleLed);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建post请求</span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;/send&quot;</span><span style="color:#E1E4E8;">, HTTP_GET, handSend);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//连接失败回调函数</span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">onNotFound</span><span style="color:#E1E4E8;">(handleNotFound); 		</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//监听http请求</span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">handleClient</span><span style="color:#E1E4E8;">();     </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//获取引脚状态</span></span>
<span class="line"><span style="color:#E1E4E8;">    pinState </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">digitalRead</span><span style="color:#E1E4E8;">(buttonPin); </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">handleRoot</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//返回html</span></span>
<span class="line"><span style="color:#E1E4E8;">	esp8266_server.</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">200</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;text/html&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;&lt;form action=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">/led</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> method=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">POST</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">&gt;&lt;input type=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">submit</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> value=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">Toggle LED</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">&gt;&lt;/form&gt;&lt;form action=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">/refresh</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> method=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">POST</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">&gt;&lt;input type=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">submit</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> value=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">REFRESH</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">&gt;&lt;/form&gt;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">handleNotFound</span><span style="color:#E1E4E8;">(){</span><span style="color:#6A737D;">	//失败回调函数</span></span>
<span class="line"><span style="color:#E1E4E8;">	esp8266_server.</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">404</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;text/plain&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;404: Not found&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">handrefresh</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//开发板Flash按键控制电位，按下时D3为高电平，不按时为低电平</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(pinState </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> HIGH){</span><span style="color:#6A737D;">	//当按键引脚D3为高电平</span></span>
<span class="line"><span style="color:#E1E4E8;">    	</span><span style="color:#B392F0;">digitalWrite</span><span style="color:#E1E4E8;">(LED_BUILTIN,</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  	} </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span><span style="color:#6A737D;">	// 当按键引脚D3为低电平</span></span>
<span class="line"><span style="color:#E1E4E8;">    	</span><span style="color:#B392F0;">digitalWrite</span><span style="color:#E1E4E8;">(LED_BUILTIN,</span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  	}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">sendHeader</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Location&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;/&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//发送Http相应代码303 跳转  </span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">303</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">handleLed</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//读取当前led的灯的状态</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">digitalRead</span><span style="color:#E1E4E8;">(LED_BUILTIN));</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//更改led灯的状态</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">digitalWrite</span><span style="color:#E1E4E8;">(LED_BUILTIN,</span><span style="color:#F97583;">!</span><span style="color:#B392F0;">digitalRead</span><span style="color:#E1E4E8;">(LED_BUILTIN));</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//跳转回页面根目录</span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">sendHeader</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Location&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;/&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//发送Http相应代码303 跳转  </span></span>
<span class="line"><span style="color:#E1E4E8;">    esp8266_server.</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">303</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">handSend</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//更改led灯的状态</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">digitalWrite</span><span style="color:#E1E4E8;">(LED_BUILTIN,</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WiFi.h&gt;</span><span style="color:#24292E;">        </span><span style="color:#6A737D;">//引入wifi库函数</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WebServer.h&gt;</span><span style="color:#24292E;">   </span><span style="color:#6A737D;">//引入webserver库函数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">buttonPin</span><span style="color:#24292E;"> D3</span><span style="color:#6A737D;">            //引入按钮引脚D3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> ssidIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ChinaNet-aemM&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> passwordIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;wp907678446&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#D73A49;">bool</span><span style="color:#24292E;"> pinState;</span><span style="color:#6A737D;">  //存储引脚状态用变量</span></span>
<span class="line"><span style="color:#24292E;">ESP8266WebServer </span><span style="color:#6F42C1;">esp8266_server</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">80</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> 	//设置服务器暴露端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">pinMode</span><span style="color:#24292E;">(LED_BUILTIN, OUTPUT);</span><span style="color:#6A737D;"> //设置内置LED引脚为输出模式以便控制LED</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">	Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">         //启动串口通讯</span></span>
<span class="line"><span style="color:#24292E;">    WiFi.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(ssidIn, passwordIn);</span><span style="color:#6A737D;">   //连接网络</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;                             </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;等待网络连接&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);                  </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;连接到的网络为:&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(WiFi.</span><span style="color:#6F42C1;">SSID</span><span style="color:#24292E;">()); </span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;分配的ip为:&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(WiFi.</span><span style="color:#6F42C1;">localIP</span><span style="color:#24292E;">()); </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//启动服务器</span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//GET请求</span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;/&quot;</span><span style="color:#24292E;">, HTTP_GET ,handleRoot);	</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//GET请求</span></span>
<span class="line"><span style="color:#24292E;">	esp8266_server.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;/refresh&quot;</span><span style="color:#24292E;">, HTTP_POST ,handrefresh);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建post请求</span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;/led&quot;</span><span style="color:#24292E;">, HTTP_POST, handleLed);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建post请求</span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;/send&quot;</span><span style="color:#24292E;">, HTTP_GET, handSend);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//连接失败回调函数</span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">onNotFound</span><span style="color:#24292E;">(handleNotFound); 		</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//监听http请求</span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">handleClient</span><span style="color:#24292E;">();     </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//获取引脚状态</span></span>
<span class="line"><span style="color:#24292E;">    pinState </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">digitalRead</span><span style="color:#24292E;">(buttonPin); </span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handleRoot</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//返回html</span></span>
<span class="line"><span style="color:#24292E;">	esp8266_server.</span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">200</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;text/html&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;&lt;form action=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">/led</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> method=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">POST</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">&gt;&lt;input type=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">submit</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> value=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">Toggle LED</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">&gt;&lt;/form&gt;&lt;form action=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">/refresh</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> method=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">POST</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">&gt;&lt;input type=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">submit</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> value=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">REFRESH</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">&gt;&lt;/form&gt;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handleNotFound</span><span style="color:#24292E;">(){</span><span style="color:#6A737D;">	//失败回调函数</span></span>
<span class="line"><span style="color:#24292E;">	esp8266_server.</span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">404</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;text/plain&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;404: Not found&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handrefresh</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//开发板Flash按键控制电位，按下时D3为高电平，不按时为低电平</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(pinState </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> HIGH){</span><span style="color:#6A737D;">	//当按键引脚D3为高电平</span></span>
<span class="line"><span style="color:#24292E;">    	</span><span style="color:#6F42C1;">digitalWrite</span><span style="color:#24292E;">(LED_BUILTIN,</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  	} </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span><span style="color:#6A737D;">	// 当按键引脚D3为低电平</span></span>
<span class="line"><span style="color:#24292E;">    	</span><span style="color:#6F42C1;">digitalWrite</span><span style="color:#24292E;">(LED_BUILTIN,</span><span style="color:#005CC5;">false</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  	}</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">sendHeader</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Location&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;/&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//发送Http相应代码303 跳转  </span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">303</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handleLed</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//读取当前led的灯的状态</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">digitalRead</span><span style="color:#24292E;">(LED_BUILTIN));</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//更改led灯的状态</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">digitalWrite</span><span style="color:#24292E;">(LED_BUILTIN,</span><span style="color:#D73A49;">!</span><span style="color:#6F42C1;">digitalRead</span><span style="color:#24292E;">(LED_BUILTIN));</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//跳转回页面根目录</span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">sendHeader</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Location&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;/&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//发送Http相应代码303 跳转  </span></span>
<span class="line"><span style="color:#24292E;">    esp8266_server.</span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">303</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handSend</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//更改led灯的状态</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">digitalWrite</span><span style="color:#24292E;">(LED_BUILTIN,</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h6 id="客户端" tabindex="-1">客户端 <a class="header-anchor" href="#客户端" aria-label="Permalink to &quot;客户端&quot;">​</a></h6><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WiFi.h&gt;</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WiFiMulti.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> ssidIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ChinaNet-aemM&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> passwordIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;wp907678446&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> host </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;192.168.1.3&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> httpPort </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">80</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//启动串口通讯</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    WiFi.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(ssidIn, passwordIn);</span><span style="color:#6A737D;">   //连接网络                            </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;等待网络连接&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);                  </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">wifiClientRequest</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">wifiClientRequest</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建client</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFiClient client;  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//拼请求</span></span>
<span class="line"><span style="color:#E1E4E8;">    String url </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;/send&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    String httpRequest </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">String</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;GET &quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> url </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; HTTP/1.1</span><span style="color:#79B8FF;">\\r\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;Host: &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> host </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;</span><span style="color:#79B8FF;">\\r\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;Connection: close</span><span style="color:#79B8FF;">\\r\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;</span><span style="color:#79B8FF;">\\r\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//连接服务器</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (client.</span><span style="color:#B392F0;">connect</span><span style="color:#E1E4E8;">(host, httpPort)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#E1E4E8;">        client.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(httpRequest);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//打印响应信息</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(httpRequest);  </span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot; failed&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    client.</span><span style="color:#B392F0;">stop</span><span style="color:#E1E4E8;">();                         </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WiFi.h&gt;</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WiFiMulti.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> ssidIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ChinaNet-aemM&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> passwordIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;wp907678446&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> host </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;192.168.1.3&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> httpPort </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">80</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//启动串口通讯</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    WiFi.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(ssidIn, passwordIn);</span><span style="color:#6A737D;">   //连接网络                            </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;等待网络连接&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);                  </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">wifiClientRequest</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">wifiClientRequest</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建client</span></span>
<span class="line"><span style="color:#24292E;">    WiFiClient client;  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//拼请求</span></span>
<span class="line"><span style="color:#24292E;">    String url </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/send&quot;</span></span>
<span class="line"><span style="color:#24292E;">    String httpRequest </span><span style="color:#D73A49;">=</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">String</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;GET &quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> url </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; HTTP/1.1</span><span style="color:#005CC5;">\\r\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;Host: &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> host </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\r\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;Connection: close</span><span style="color:#005CC5;">\\r\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\r\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//连接服务器</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (client.</span><span style="color:#6F42C1;">connect</span><span style="color:#24292E;">(host, httpPort)) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#24292E;">        client.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(httpRequest);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//打印响应信息</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(httpRequest);  </span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot; failed&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    client.</span><span style="color:#6F42C1;">stop</span><span style="color:#24292E;">();                         </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h6 id="esp8266httpclient" tabindex="-1">ESP8266HTTPClient <a class="header-anchor" href="#esp8266httpclient" aria-label="Permalink to &quot;ESP8266HTTPClient&quot;">​</a></h6><ul><li>GET</li></ul><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WiFi.h&gt;</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266HTTPClient.h&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> ssidIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ChinaNet-aemM&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> passwordIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;wp907678446&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">//启动串口通讯</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//连接网络</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFi.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(ssidIn, passwordIn);          </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;等待网络连接&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);                  </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ((WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> WL_CONNECTED)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">http_get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http_get</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建client</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFiClient client;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建http对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    HTTPClient http;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//配置请求地址</span></span>
<span class="line"><span style="color:#E1E4E8;">    http.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(client, </span><span style="color:#9ECBFF;">&quot;http://api.seniverse.com/v3/weather/now.json?key=SpciTJPArpECQAq0t&amp;location=Beijing&amp;language=en&amp;unit=c&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> httpCode </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> http.</span><span style="color:#B392F0;">GET</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//判断响应</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (httpCode </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> HTTP_CODE_OK) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        String responsePayload </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> http.</span><span style="color:#B392F0;">getString</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Server Response Payload: &quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(responsePayload);</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Server Respose Code：&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(httpCode);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    http.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WiFi.h&gt;</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266HTTPClient.h&gt;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> ssidIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ChinaNet-aemM&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> passwordIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;wp907678446&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">//启动串口通讯</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//连接网络</span></span>
<span class="line"><span style="color:#24292E;">    WiFi.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(ssidIn, passwordIn);          </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;等待网络连接&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);                  </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ((WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> WL_CONNECTED)) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">http_get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http_get</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">  </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建client</span></span>
<span class="line"><span style="color:#24292E;">    WiFiClient client;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建http对象</span></span>
<span class="line"><span style="color:#24292E;">    HTTPClient http;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//配置请求地址</span></span>
<span class="line"><span style="color:#24292E;">    http.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(client, </span><span style="color:#032F62;">&quot;http://api.seniverse.com/v3/weather/now.json?key=SpciTJPArpECQAq0t&amp;location=Beijing&amp;language=en&amp;unit=c&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> httpCode </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> http.</span><span style="color:#6F42C1;">GET</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//判断响应</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (httpCode </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> HTTP_CODE_OK) {</span></span>
<span class="line"><span style="color:#24292E;">        String responsePayload </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> http.</span><span style="color:#6F42C1;">getString</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Server Response Payload: &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(responsePayload);</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Server Respose Code：&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(httpCode);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    http.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li>POST <a href="http://www.taichi-maker.com/homepage/iot-development/iot-dev-reference/esp8266-c-plus-plus-reference/esp8266httpclient/post/" target="_blank" rel="noreferrer">参考</a></li></ul><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WiFi.h&gt;</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266HTTPClient.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> ssidIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ChinaNet-aemM&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> passwordIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;wp907678446&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//启动串口通讯</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//连接网络</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFi.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(ssidIn, passwordIn);          </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;等待网络连接&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);                  </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ((WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> WL_CONNECTED)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">http_post</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http_post</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建client</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFiClient client;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建http对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    HTTPClient http;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//配置请求地址</span></span>
<span class="line"><span style="color:#E1E4E8;">    http.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(client, </span><span style="color:#9ECBFF;">&quot;http://192.168.1.3:8081/posttest&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> httpCode </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> http.</span><span style="color:#B392F0;">POST</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;this is Requestbody&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//连接失败时 httpCode时为负数</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (httpCode </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//打印响应头</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">printf</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;[HTTP] POST... code: </span><span style="color:#79B8FF;">%d\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">, httpCode);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//响应信息判断</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (httpCode </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> HTTP_CODE_OK) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> String</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> payload </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> http.</span><span style="color:#B392F0;">getString</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;received payload:</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&lt;&lt;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">            Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(payload);</span></span>
<span class="line"><span style="color:#E1E4E8;">            Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&gt;&gt;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">printf</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;[HTTP] POST... failed, error: </span><span style="color:#79B8FF;">%s\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">, http.</span><span style="color:#B392F0;">errorToString</span><span style="color:#E1E4E8;">(httpCode).</span><span style="color:#B392F0;">c_str</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//关闭http连接</span></span>
<span class="line"><span style="color:#E1E4E8;">    http.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WiFi.h&gt;</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266HTTPClient.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> ssidIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ChinaNet-aemM&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> passwordIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;wp907678446&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//启动串口通讯</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//连接网络</span></span>
<span class="line"><span style="color:#24292E;">    WiFi.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(ssidIn, passwordIn);          </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;等待网络连接&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);                  </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ((WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> WL_CONNECTED)) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">http_post</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http_post</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建client</span></span>
<span class="line"><span style="color:#24292E;">    WiFiClient client;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建http对象</span></span>
<span class="line"><span style="color:#24292E;">    HTTPClient http;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//配置请求地址</span></span>
<span class="line"><span style="color:#24292E;">    http.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(client, </span><span style="color:#032F62;">&quot;http://192.168.1.3:8081/posttest&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> httpCode </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> http.</span><span style="color:#6F42C1;">POST</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;this is Requestbody&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//连接失败时 httpCode时为负数</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (httpCode </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//打印响应头</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">printf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;[HTTP] POST... code: </span><span style="color:#005CC5;">%d\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, httpCode);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//响应信息判断</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (httpCode </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> HTTP_CODE_OK) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> String</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> payload </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> http.</span><span style="color:#6F42C1;">getString</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;received payload:</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&lt;&lt;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">            Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(payload);</span></span>
<span class="line"><span style="color:#24292E;">            Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&gt;&gt;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">printf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;[HTTP] POST... failed, error: </span><span style="color:#005CC5;">%s\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, http.</span><span style="color:#6F42C1;">errorToString</span><span style="color:#24292E;">(httpCode).</span><span style="color:#6F42C1;">c_str</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//关闭http连接</span></span>
<span class="line"><span style="color:#24292E;">    http.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_4-闪存文件" tabindex="-1">4.闪存文件 <a class="header-anchor" href="#_4-闪存文件" aria-label="Permalink to &quot;4.闪存文件&quot;">​</a></h5><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;FS.h&gt;</span><span style="color:#E1E4E8;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//创建文件夹目录</span></span>
<span class="line"><span style="color:#E1E4E8;">String folder_name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;/source&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#6A737D;">//设置文件路径</span></span>
<span class="line"><span style="color:#E1E4E8;">String file_name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;/source/test.txt&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">String d_file_name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;/source/delete.txt&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  	Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  	Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//格式化闪存</span></span>
<span class="line"><span style="color:#E1E4E8;">  	SPIFFS.</span><span style="color:#B392F0;">format</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(SPIFFS.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">()){</span><span style="color:#6A737D;"> // 启动SPIFFS</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;SPIFFS Started.&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;SPIFFS Failed to Start.&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//建立文件夹目录</span></span>
<span class="line"><span style="color:#E1E4E8;">    Dir dir </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> SPIFFS.</span><span style="color:#B392F0;">openDir</span><span style="color:#E1E4E8;">(folder_name);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//打印该目录的所有文件名</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (dir.</span><span style="color:#B392F0;">next</span><span style="color:#E1E4E8;">()) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(dir.</span><span style="color:#B392F0;">fileName</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//删除文件</span></span>
<span class="line"><span style="color:#E1E4E8;">    SPIFFS.</span><span style="color:#B392F0;">remove</span><span style="color:#E1E4E8;">(d_file_name)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//打开文件流</span></span>
<span class="line"><span style="color:#E1E4E8;">    File dataFileWrite </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> SPIFFS.</span><span style="color:#B392F0;">open</span><span style="color:#E1E4E8;">(file_name, </span><span style="color:#9ECBFF;">&quot;w&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//写入数据</span></span>
<span class="line"><span style="color:#E1E4E8;">    dataFileWrite.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Hello World&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//关闭文件流</span></span>
<span class="line"><span style="color:#E1E4E8;">    dataFileWrite.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//确认闪存中是否有file_name文件</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (SPIFFS.</span><span style="color:#B392F0;">exists</span><span style="color:#E1E4E8;">(file_name)){</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(file_name);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot; FOUND.&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(file_name);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot; NOT FOUND.&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//打开文件流</span></span>
<span class="line"><span style="color:#E1E4E8;">    File dataFileRead </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> SPIFFS.</span><span style="color:#B392F0;">open</span><span style="color:#E1E4E8;">(file_name, </span><span style="color:#9ECBFF;">&quot;r&quot;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//读取文件内容并且通过串口监视器输出文件信息</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">dataFileRead.</span><span style="color:#B392F0;">size</span><span style="color:#E1E4E8;">(); i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">((</span><span style="color:#F97583;">char</span><span style="color:#E1E4E8;">)dataFileRead.</span><span style="color:#B392F0;">read</span><span style="color:#E1E4E8;">());       </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//关闭文件流</span></span>
<span class="line"><span style="color:#E1E4E8;">    dataFileRead.</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//追加信息</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//File dataFile = SPIFFS.open(file_name, &quot;a&quot;);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;FS.h&gt;</span><span style="color:#24292E;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//创建文件夹目录</span></span>
<span class="line"><span style="color:#24292E;">String folder_name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/source&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6A737D;">//设置文件路径</span></span>
<span class="line"><span style="color:#24292E;">String file_name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/source/test.txt&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">String d_file_name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/source/delete.txt&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  	Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  	Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//格式化闪存</span></span>
<span class="line"><span style="color:#24292E;">  	SPIFFS.</span><span style="color:#6F42C1;">format</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(SPIFFS.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">()){</span><span style="color:#6A737D;"> // 启动SPIFFS</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;SPIFFS Started.&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;SPIFFS Failed to Start.&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//建立文件夹目录</span></span>
<span class="line"><span style="color:#24292E;">    Dir dir </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SPIFFS.</span><span style="color:#6F42C1;">openDir</span><span style="color:#24292E;">(folder_name);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//打印该目录的所有文件名</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (dir.</span><span style="color:#6F42C1;">next</span><span style="color:#24292E;">()) {</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(dir.</span><span style="color:#6F42C1;">fileName</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//删除文件</span></span>
<span class="line"><span style="color:#24292E;">    SPIFFS.</span><span style="color:#6F42C1;">remove</span><span style="color:#24292E;">(d_file_name)</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//打开文件流</span></span>
<span class="line"><span style="color:#24292E;">    File dataFileWrite </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SPIFFS.</span><span style="color:#6F42C1;">open</span><span style="color:#24292E;">(file_name, </span><span style="color:#032F62;">&quot;w&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//写入数据</span></span>
<span class="line"><span style="color:#24292E;">    dataFileWrite.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Hello World&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//关闭文件流</span></span>
<span class="line"><span style="color:#24292E;">    dataFileWrite.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//确认闪存中是否有file_name文件</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (SPIFFS.</span><span style="color:#6F42C1;">exists</span><span style="color:#24292E;">(file_name)){</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(file_name);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot; FOUND.&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(file_name);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot; NOT FOUND.&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//打开文件流</span></span>
<span class="line"><span style="color:#24292E;">    File dataFileRead </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SPIFFS.</span><span style="color:#6F42C1;">open</span><span style="color:#24292E;">(file_name, </span><span style="color:#032F62;">&quot;r&quot;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//读取文件内容并且通过串口监视器输出文件信息</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">dataFileRead.</span><span style="color:#6F42C1;">size</span><span style="color:#24292E;">(); i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">((</span><span style="color:#D73A49;">char</span><span style="color:#24292E;">)dataFileRead.</span><span style="color:#6F42C1;">read</span><span style="color:#24292E;">());       </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//关闭文件流</span></span>
<span class="line"><span style="color:#24292E;">    dataFileRead.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//追加信息</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//File dataFile = SPIFFS.open(file_name, &quot;a&quot;);</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_5-oled" tabindex="-1">5.OLED <a class="header-anchor" href="#_5-oled" aria-label="Permalink to &quot;5.OLED&quot;">​</a></h5><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;SPI.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载SPI库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Wire.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Wire库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Adafruit_GFX.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Adafruit_GFX库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Adafruit_SSD1306.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Adafruit_SSD1306库</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">char</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">temp</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span><span style="color:#9ECBFF;">&#39;a&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;b&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;c&#39;</span><span style="color:#E1E4E8;">};</span></span>
<span class="line"><span style="color:#6A737D;">// 定义 OLED屏幕的分辨率</span></span>
<span class="line"><span style="color:#E1E4E8;">Adafruit_SSD1306 display </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Adafruit_SSD1306</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">128</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">64</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#FFAB70;">Wire</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">115200</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#E1E4E8;">  Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;OLED FeatherWing test&quot;</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 串口输出</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">3C</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">clearDisplay</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> // 清空屏幕</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">setTextSize</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置字体大小</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">setTextColor</span><span style="color:#E1E4E8;">(SSD1306_WHITE);</span><span style="color:#6A737D;"> // 设置字体颜色</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">setCursor</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置开始显示文字的坐标</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Hello World!&quot;</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 输出的字符</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">display</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> // 使更改的显示生效</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;SPI.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载SPI库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Wire.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Wire库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Adafruit_GFX.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Adafruit_GFX库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Adafruit_SSD1306.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Adafruit_SSD1306库</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">char</span><span style="color:#24292E;"> </span><span style="color:#E36209;">temp</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span><span style="color:#032F62;">&#39;a&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;b&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;c&#39;</span><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#6A737D;">// 定义 OLED屏幕的分辨率</span></span>
<span class="line"><span style="color:#24292E;">Adafruit_SSD1306 display </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Adafruit_SSD1306</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">128</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">64</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#E36209;">Wire</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">115200</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#24292E;">  Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;OLED FeatherWing test&quot;</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 串口输出</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">3C</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">clearDisplay</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> // 清空屏幕</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">setTextSize</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置字体大小</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">setTextColor</span><span style="color:#24292E;">(SSD1306_WHITE);</span><span style="color:#6A737D;"> // 设置字体颜色</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">setCursor</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置开始显示文字的坐标</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Hello World!&quot;</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 输出的字符</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">display</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> // 使更改的显示生效</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {}</span></span></code></pre></div><h5 id="_6-心知天气" tabindex="-1">6.心知天气 <a class="header-anchor" href="#_6-心知天气" aria-label="Permalink to &quot;6.心知天气&quot;">​</a></h5><div class="language-C vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266WiFi.h&gt;</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ESP8266HTTPClient.h&gt;</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;ArduinoJson.h&gt;</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;SPI.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载SPI库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Wire.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Wire库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Adafruit_GFX.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Adafruit_GFX库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Adafruit_SSD1306.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Adafruit_SSD1306库</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> ssidIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ChinaNet-aemM&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> passwordIn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;wp907678446&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 定义 OLED屏幕的分辨率</span></span>
<span class="line"><span style="color:#E1E4E8;">Adafruit_SSD1306 display </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Adafruit_SSD1306</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">128</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">64</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#FFAB70;">Wire</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">//启动串口通讯</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//连接网络</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFi.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(ssidIn, passwordIn);          </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;等待网络连接&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);                  </span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">115200</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">3C</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ((WiFi.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> WL_CONNECTED)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">http_get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http_get</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建client</span></span>
<span class="line"><span style="color:#E1E4E8;">    WiFiClient client;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//创建http对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    HTTPClient http;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//配置请求地址</span></span>
<span class="line"><span style="color:#E1E4E8;">    http.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(client, </span><span style="color:#9ECBFF;">&quot;http://api.seniverse.com/v3/weather/now.json?key=SpciTJPArpECQAq0t&amp;location=ChongQing&amp;language=en&amp;unit=c&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> httpCode </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> http.</span><span style="color:#B392F0;">GET</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//判断响应</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (httpCode </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> HTTP_CODE_OK) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        String responsePayload </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> http.</span><span style="color:#B392F0;">getString</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">size_t</span><span style="color:#E1E4E8;"> capacity </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">JSON_ARRAY_SIZE</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">JSON_OBJECT_SIZE</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#F97583;">*</span><span style="color:#B392F0;">JSON_OBJECT_SIZE</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">JSON_OBJECT_SIZE</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">230</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        DynamicJsonBuffer </span><span style="color:#B392F0;">jsonBuffer</span><span style="color:#E1E4E8;">(capacity);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> json </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> responsePayload.</span><span style="color:#B392F0;">c_str</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        JsonObject</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> root </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> jsonBuffer.</span><span style="color:#B392F0;">parseObject</span><span style="color:#E1E4E8;">(json);</span></span>
<span class="line"><span style="color:#E1E4E8;">        JsonObject</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> results_0 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">root</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;results&quot;</span><span style="color:#E1E4E8;">][</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">        JsonObject</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> results_0_location </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;location&quot;</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_location_id </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0_location</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;id&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;WX4FBXXFKE4F&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_location_name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0_location</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;name&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;Beijing&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_location_country </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0_location</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;country&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;CN&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_location_path </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0_location</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;path&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;Beijing,Beijing,China&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_location_timezone </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0_location</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;timezone&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;Asia/Shanghai&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_location_timezone_offset </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0_location</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;timezone_offset&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;+08:00&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">        JsonObject</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> results_0_now </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;now&quot;</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_now_text </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0_now</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;Sunny&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_now_code </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0_now</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;code&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;0&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_now_temperature </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0_now</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;temperature&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;24&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char*</span><span style="color:#E1E4E8;"> results_0_last_update </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">results_0</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;last_update&quot;</span><span style="color:#E1E4E8;">];</span><span style="color:#6A737D;"> // &quot;2022-05-03T12:00:49+08:00&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot; &quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;====================================&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(results_0_now_text);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(results_0_now_temperature);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(results_0_last_update);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;====================================&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot; &quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">115200</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;OLED FeatherWing test&quot;</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 串口输出</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">3C</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">clearDisplay</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> // 清空屏幕</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">setTextSize</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1.5</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置字体大小</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">setTextColor</span><span style="color:#E1E4E8;">(SSD1306_WHITE);</span><span style="color:#6A737D;"> // 设置字体颜色</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">setCursor</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置开始显示文字的坐标</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Hello World!&quot;</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 输出的字符</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Weather:   &quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(results_0_now_text);</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Temperature:   &quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(results_0_now_temperature);</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Time:   &quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(results_0_last_update);</span></span>
<span class="line"><span style="color:#E1E4E8;">        display.</span><span style="color:#B392F0;">display</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> // 使更改的显示生效</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Server Respose Code：&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Serial.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(httpCode);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    http.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266WiFi.h&gt;</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ESP8266HTTPClient.h&gt;</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;ArduinoJson.h&gt;</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;SPI.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载SPI库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Wire.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Wire库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Adafruit_GFX.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Adafruit_GFX库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Adafruit_SSD1306.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Adafruit_SSD1306库</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> ssidIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ChinaNet-aemM&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">   //定义用户名</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> passwordIn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;wp907678446&quot;</span><span style="color:#24292E;">;</span><span style="color:#6A737D;"> //定义密码</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 定义 OLED屏幕的分辨率</span></span>
<span class="line"><span style="color:#24292E;">Adafruit_SSD1306 display </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Adafruit_SSD1306</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">128</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">64</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#E36209;">Wire</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">//启动串口通讯</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//连接网络</span></span>
<span class="line"><span style="color:#24292E;">    WiFi.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(ssidIn, passwordIn);          </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;等待网络连接&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);                  </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">115200</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">3C</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ((WiFi.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> WL_CONNECTED)) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">http_get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http_get</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">  </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建client</span></span>
<span class="line"><span style="color:#24292E;">    WiFiClient client;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//创建http对象</span></span>
<span class="line"><span style="color:#24292E;">    HTTPClient http;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//配置请求地址</span></span>
<span class="line"><span style="color:#24292E;">    http.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(client, </span><span style="color:#032F62;">&quot;http://api.seniverse.com/v3/weather/now.json?key=SpciTJPArpECQAq0t&amp;location=ChongQing&amp;language=en&amp;unit=c&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//发送请求</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> httpCode </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> http.</span><span style="color:#6F42C1;">GET</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//判断响应</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (httpCode </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> HTTP_CODE_OK) {</span></span>
<span class="line"><span style="color:#24292E;">        String responsePayload </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> http.</span><span style="color:#6F42C1;">getString</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">size_t</span><span style="color:#24292E;"> capacity </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">JSON_ARRAY_SIZE</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">JSON_OBJECT_SIZE</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#D73A49;">*</span><span style="color:#6F42C1;">JSON_OBJECT_SIZE</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">JSON_OBJECT_SIZE</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">6</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">230</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        DynamicJsonBuffer </span><span style="color:#6F42C1;">jsonBuffer</span><span style="color:#24292E;">(capacity);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> json </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> responsePayload.</span><span style="color:#6F42C1;">c_str</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        JsonObject</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> root </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> jsonBuffer.</span><span style="color:#6F42C1;">parseObject</span><span style="color:#24292E;">(json);</span></span>
<span class="line"><span style="color:#24292E;">        JsonObject</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> results_0 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">root</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;results&quot;</span><span style="color:#24292E;">][</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        JsonObject</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> results_0_location </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;location&quot;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_location_id </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0_location</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;id&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;WX4FBXXFKE4F&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_location_name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0_location</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;Beijing&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_location_country </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0_location</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;country&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;CN&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_location_path </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0_location</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;path&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;Beijing,Beijing,China&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_location_timezone </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0_location</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;timezone&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;Asia/Shanghai&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_location_timezone_offset </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0_location</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;timezone_offset&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;+08:00&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        JsonObject</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> results_0_now </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;now&quot;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_now_text </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0_now</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;Sunny&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_now_code </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0_now</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;code&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;0&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_now_temperature </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0_now</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;temperature&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;24&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">char*</span><span style="color:#24292E;"> results_0_last_update </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#E36209;">results_0</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;last_update&quot;</span><span style="color:#24292E;">];</span><span style="color:#6A737D;"> // &quot;2022-05-03T12:00:49+08:00&quot;</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot; &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;====================================&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(results_0_now_text);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(results_0_now_temperature);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(results_0_last_update);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;====================================&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot; &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">115200</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;OLED FeatherWing test&quot;</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 串口输出</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">3C</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">clearDisplay</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> // 清空屏幕</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">setTextSize</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1.5</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置字体大小</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">setTextColor</span><span style="color:#24292E;">(SSD1306_WHITE);</span><span style="color:#6A737D;"> // 设置字体颜色</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">setCursor</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置开始显示文字的坐标</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Hello World!&quot;</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 输出的字符</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Weather:   &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(results_0_now_text);</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Temperature:   &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(results_0_now_temperature);</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Time:   &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(results_0_last_update);</span></span>
<span class="line"><span style="color:#24292E;">        display.</span><span style="color:#6F42C1;">display</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> // 使更改的显示生效</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Server Respose Code：&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Serial.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(httpCode);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    http.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_7-汉字显示" tabindex="-1">7.汉字显示 <a class="header-anchor" href="#_7-汉字显示" aria-label="Permalink to &quot;7.汉字显示&quot;">​</a></h5><ul><li>test.h</li></ul><div class="language-h vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">h</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">static const unsigned char PROGMEM hans_wen[] = {</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x02,0x00,0x01,0x00,0x01,0x00,0xFF,0xFE,0x10,0x10,0x10,0x10,0x08,0x20,0x08,0x20,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x04,0x40,0x02,0x80,0x01,0x00,0x02,0x80,0x04,0x40,0x08,0x20,0x30,0x18,0xC0,0x06,/*&quot;文&quot;,0*/</span></span>
<span class="line"><span style="color:#e1e4e8;">};</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">static const unsigned char PROGMEM hans_peng[] = {</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x10,0x77,0x20,0x55,0x7C,0x55,0x44,0x55,0x64,0x77,0x54,0x55,0x44,0x55,0x4C,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x55,0x40,0x77,0x7E,0x55,0x02,0x55,0x02,0x55,0x7A,0xB5,0x02,0x89,0x0A,0x13,0x04,/*&quot;鹏&quot;,1*/</span></span>
<span class="line"><span style="color:#e1e4e8;">};</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">static const unsigned char PROGMEM hans_xiao[] = {</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x11,0x10,0x11,0x08,0x11,0x04,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x21,0x04,0x21,0x02,0x41,0x02,0x81,0x02,0x01,0x00,0x01,0x00,0x05,0x00,0x02,0x00,/*&quot;小&quot;,2*/</span></span>
<span class="line"><span style="color:#e1e4e8;">};</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">static const unsigned char PROGMEM hans_pang[] = {</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x20,0x3C,0x20,0x25,0x24,0x24,0xA4,0x24,0xA8,0x3C,0x20,0x25,0xFC,0x24,0x20,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x24,0x20,0x3C,0x20,0x27,0xFE,0x24,0x20,0x24,0x20,0x44,0x20,0x54,0x20,0x88,0x20,/*&quot;胖&quot;,3*/</span></span>
<span class="line"><span style="color:#e1e4e8;">};</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">static const unsigned char PROGMEM hans_zi[] = {</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x00,0x7F,0xF8,0x00,0x10,0x00,0x20,0x00,0x40,0x01,0x80,0x01,0x00,0xFF,0xFE,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x05,0x00,0x02,0x00,/*&quot;子&quot;,4*/</span></span>
<span class="line"><span style="color:#e1e4e8;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">static const unsigned char PROGMEM hans_wen[] = {</span></span>
<span class="line"><span style="color:#24292e;">	0x02,0x00,0x01,0x00,0x01,0x00,0xFF,0xFE,0x10,0x10,0x10,0x10,0x08,0x20,0x08,0x20,</span></span>
<span class="line"><span style="color:#24292e;">	0x04,0x40,0x02,0x80,0x01,0x00,0x02,0x80,0x04,0x40,0x08,0x20,0x30,0x18,0xC0,0x06,/*&quot;文&quot;,0*/</span></span>
<span class="line"><span style="color:#24292e;">};</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">static const unsigned char PROGMEM hans_peng[] = {</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x10,0x77,0x20,0x55,0x7C,0x55,0x44,0x55,0x64,0x77,0x54,0x55,0x44,0x55,0x4C,</span></span>
<span class="line"><span style="color:#24292e;">	0x55,0x40,0x77,0x7E,0x55,0x02,0x55,0x02,0x55,0x7A,0xB5,0x02,0x89,0x0A,0x13,0x04,/*&quot;鹏&quot;,1*/</span></span>
<span class="line"><span style="color:#24292e;">};</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">static const unsigned char PROGMEM hans_xiao[] = {</span></span>
<span class="line"><span style="color:#24292e;">	0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x11,0x10,0x11,0x08,0x11,0x04,</span></span>
<span class="line"><span style="color:#24292e;">	0x21,0x04,0x21,0x02,0x41,0x02,0x81,0x02,0x01,0x00,0x01,0x00,0x05,0x00,0x02,0x00,/*&quot;小&quot;,2*/</span></span>
<span class="line"><span style="color:#24292e;">};</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">static const unsigned char PROGMEM hans_pang[] = {</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x20,0x3C,0x20,0x25,0x24,0x24,0xA4,0x24,0xA8,0x3C,0x20,0x25,0xFC,0x24,0x20,</span></span>
<span class="line"><span style="color:#24292e;">	0x24,0x20,0x3C,0x20,0x27,0xFE,0x24,0x20,0x24,0x20,0x44,0x20,0x54,0x20,0x88,0x20,/*&quot;胖&quot;,3*/</span></span>
<span class="line"><span style="color:#24292e;">};</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">static const unsigned char PROGMEM hans_zi[] = {</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x00,0x7F,0xF8,0x00,0x10,0x00,0x20,0x00,0x40,0x01,0x80,0x01,0x00,0xFF,0xFE,</span></span>
<span class="line"><span style="color:#24292e;">	0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x05,0x00,0x02,0x00,/*&quot;子&quot;,4*/</span></span>
<span class="line"><span style="color:#24292e;">};</span></span></code></pre></div><ul><li>代码</li></ul><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;SPI.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载SPI库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Wire.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Wire库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Adafruit_GFX.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Adafruit_GFX库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Adafruit_SSD1306.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Adafruit_SSD1306库</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;test.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 定义 OLED屏幕的分辨率</span></span>
<span class="line"><span style="color:#E1E4E8;">Adafruit_SSD1306 display </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Adafruit_SSD1306</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">128</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">64</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#FFAB70;">Wire</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">115200</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">3C</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">hans_display</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">display_test</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">clearDisplay</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> // 清空屏幕</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">setTextSize</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1.5</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置字体大小</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">setTextColor</span><span style="color:#E1E4E8;">(SSD1306_WHITE);</span><span style="color:#6A737D;"> // 设置字体颜色</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">setCursor</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置开始显示文字的坐标</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Hello World!&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">setCursor</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;time: &quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">//打印自开发板重置以来的秒数：</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">millis</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot; s&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">setCursor</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">40</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Author: &quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Dapenson&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">display</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> // 使更改的显示生效</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">hans_display</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 显示之前清屏</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">clearDisplay</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 显示文字 (左上角x坐标,左上角y坐标, 图形数组, 图形宽度像素点, 图形高度像素点, 设置颜色)</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">drawBitmap</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, hans_wen, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">drawBitmap</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, hans_peng, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">drawBitmap</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, hans_xiao, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">drawBitmap</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, hans_pang, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">drawBitmap</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, hans_zi, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//显示图形</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">display</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;SPI.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载SPI库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Wire.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Wire库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Adafruit_GFX.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Adafruit_GFX库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Adafruit_SSD1306.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Adafruit_SSD1306库</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;test.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 定义 OLED屏幕的分辨率</span></span>
<span class="line"><span style="color:#24292E;">Adafruit_SSD1306 display </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Adafruit_SSD1306</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">128</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">64</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#E36209;">Wire</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">115200</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">3C</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">hans_display</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">display_test</span><span style="color:#24292E;">(){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">clearDisplay</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> // 清空屏幕</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">setTextSize</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1.5</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置字体大小</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">setTextColor</span><span style="color:#24292E;">(SSD1306_WHITE);</span><span style="color:#6A737D;"> // 设置字体颜色</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">setCursor</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置开始显示文字的坐标</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Hello World!&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">setCursor</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;time: &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">//打印自开发板重置以来的秒数：</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">millis</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot; s&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">setCursor</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">40</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Author: &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Dapenson&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">display</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> // 使更改的显示生效</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">hans_display</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 显示之前清屏</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">clearDisplay</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 显示文字 (左上角x坐标,左上角y坐标, 图形数组, 图形宽度像素点, 图形高度像素点, 设置颜色)</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">drawBitmap</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">20</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, hans_wen, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">drawBitmap</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">20</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, hans_peng, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">drawBitmap</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">20</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, hans_xiao, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">drawBitmap</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">20</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, hans_pang, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">drawBitmap</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">20</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, hans_zi, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//显示图形</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">display</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_8-图片显示" tabindex="-1">8.图片显示 <a class="header-anchor" href="#_8-图片显示" aria-label="Permalink to &quot;8.图片显示&quot;">​</a></h5><div class="language-h vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">h</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">static const unsigned char PROGMEM boy[] = {</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0x0F,0xFF,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xF0,0xFF,0xFF,0xFE,0x01,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFE,0x3F,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0x01,0xFF,0xF0,0xFF,0xFF,0xFE,0x3B,0xFF,0xF8,0x03,0x87,0xF0,0xFD,0xFF,0xFE,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xC0,0x01,0xCF,0xF0,0xFF,0xFF,0xFC,0xF8,0xFC,0x00,0x07,0xFF,0xF0,0xEE,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xC0,0xE0,0x00,0x7F,0xFF,0xF0,0xF0,0xE9,0xFF,0xF0,0x00,0x01,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xF0,0xFC,0xE3,0xFF,0xC0,0x00,0x01,0xFF,0xFF,0xF0,0xFD,0x2F,0xFF,0x80,0x00,0x03,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xF0,0xFC,0x10,0xFF,0xE0,0x00,0x07,0xFF,0xFF,0xF0,0xFE,0x2D,0xFF,0x80,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x0F,0xFF,0xFF,0xF0,0xFF,0x65,0xFF,0xC0,0x00,0x1F,0xFF,0xFF,0xF0,0xFD,0xE7,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xC0,0x00,0x3F,0xFF,0xFF,0xF0,0xFF,0x83,0xFF,0x80,0x00,0x3F,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0x97,0xFF,0x00,0x00,0x3F,0xFF,0xFF,0xF0,0xFF,0x8F,0xFE,0x00,0x00,0x3F,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xF0,0xFF,0xDF,0xFE,0x70,0x00,0x3F,0xFF,0xFF,0xF0,0xFD,0xFF,0xEF,0xF8,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x3F,0xFF,0xFF,0xF0,0xFD,0xFF,0xFB,0xFC,0x00,0x1F,0xFF,0xFF,0xF0,0xFD,0xBF,0xA1,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xC4,0x00,0x1F,0xFF,0xFF,0xF0,0xFD,0xBF,0xF0,0xF0,0x00,0x1F,0xFF,0xFF,0xF0,0xFD,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x9F,0xF0,0x00,0x00,0x1F,0xFF,0xFF,0xF0,0xFF,0x03,0xD0,0x00,0x00,0x0F,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xF0,0xFF,0x01,0x62,0x00,0x00,0x0F,0xFF,0xFF,0xF0,0xFF,0x80,0x07,0x00,0x00,0x07,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xF0,0xFF,0xC0,0x0F,0x00,0x00,0x03,0xFF,0xFF,0xF0,0xFB,0xE0,0x3F,0x80,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x03,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xC0,0x00,0x01,0xFF,0xFF,0xF0,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xC0,0x00,0x03,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xC0,0x00,0x03,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xFF,0xC0,0x00,0x01,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xE0,0x00,0x01,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xF0,0xFF,0xFF,0xFF,0xE1,0xFE,0x00,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xE7,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xC0,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xEF,0xFF,0xF8,0x7F,0xFF,0xF0,0xFF,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xDF,0xF3,0xFC,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xC8,0x3F,0xFF,0xFF,0xF0,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xFF,0xF0,0x7F,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0x87,0x2F,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xF0,0xFF,0xFF,0xFF,0xFF,0xCF,0xBF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0x1F,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xEF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFE,0x3F,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFC,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x7F,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xF8,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xF1,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xE3,0xFF,0xFF,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xFF,0x87,0xFF,0xFE,0xFF,0xFF,0xF0,0xFF,0xFF,0xFE,0x0F,0xFF,0xFF,0xFD,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xF0,0xFF,0xFF,0xFC,0x1F,0xFF,0xFF,0x71,0xFF,0xF0,0xFF,0xFF,0xF8,0x3F,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xD1,0xFF,0xF0,0xFF,0xFF,0xF0,0x3F,0xFF,0xFF,0xF9,0xFF,0xF0,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x7F,0xFF,0xFF,0xF9,0xFF,0xF0,0xFF,0xFF,0xE9,0xFF,0xFF,0xFF,0xF9,0xFF,0xF0,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xF9,0xFF,0xFF,0xFF,0xF8,0xFF,0xF0,0xFF,0xFF,0xF3,0xFF,0xFF,0xFF,0xFC,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xF0,0xFF,0xFF,0xC7,0xFF,0xFF,0xFF,0xFC,0x7F,0xF0,0xFF,0xFD,0x8F,0xFF,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFC,0xFF,0xF0,0xFF,0xFD,0x0F,0xFF,0xFF,0xFF,0xEC,0xFF,0xF0,0xFF,0xF8,0x7F,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xFC,0xFF,0xF0,0xFF,0xFC,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xF0,0xFF,0xF8,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xFF,0xFF,0xF0,0x7F,0xF0,0xFF,0xFC,0xFF,0xFF,0xFF,0xFF,0xF0,0x7F,0xF0,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xF7,0xBF,0xF0,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xF7,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xF0,0xFF,0x00,0x7F,0xFF,0xFF,0xFF,0xF7,0x9F,0xF0,0xFF,0x00,0x00,0x00,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x01,0xFB,0x80,0x30,0xFF,0xFF,0xFF,0xFF,0x1F,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#e1e4e8;">};</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">static const unsigned char PROGMEM girl[] = {</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFF,0xFC,0x01,0xFF,0xFF,0xFC,0xFF,0xC0,0x00,0x7F,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0xFC,0xFF,0x80,0x00,0x1F,0xFF,0xFC,0xFE,0x00,0x00,0x0F,0xFF,0xFC,0xFE,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x03,0xFF,0xFC,0xFC,0x00,0x00,0x01,0xFF,0xFC,0xF8,0x00,0x00,0x01,0xFF,0xFC,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xF8,0x00,0x00,0x00,0xFF,0xFC,0xF0,0x00,0x00,0x00,0xFF,0xFC,0xF8,0x00,0x00,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x7F,0xFC,0xF8,0x00,0x00,0x00,0x7F,0xFC,0xE0,0x00,0x00,0x00,0x7F,0xFC,0xE0,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x00,0xFF,0xFC,0xF0,0x00,0x00,0x00,0x7F,0xFC,0xF0,0x00,0x08,0x00,0x3F,0xFC,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xF0,0x00,0x18,0x00,0x3F,0xFC,0xE0,0x00,0x10,0x0F,0x3F,0xFC,0xE0,0x00,0x34,0x7F,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x3F,0xFC,0xE0,0x00,0x3F,0xFF,0x3F,0xFC,0xE0,0x00,0x3F,0x0F,0xBF,0xFC,0xE0,0x10,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x3F,0xFF,0x9F,0xFC,0xE0,0x30,0x3F,0xFF,0xDF,0xFC,0xE0,0x38,0x7F,0xFF,0xDF,0xFC,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xC0,0x3C,0x7F,0xFF,0xFF,0xFC,0xC0,0x3C,0x7F,0xFF,0x9F,0xFC,0xC0,0x1C,0x7F,0xFF,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x9F,0xFC,0xC0,0x04,0x3F,0xFC,0x1F,0xFC,0xC0,0x00,0x3F,0xFF,0x1F,0xFC,0xC0,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x7F,0xFF,0x1F,0xFC,0xC0,0x00,0x7F,0xFF,0x1F,0xFC,0x80,0x00,0x7F,0xFF,0x1F,0xFC,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x80,0x00,0x7C,0x7E,0x1F,0xFC,0x80,0x00,0x7E,0x00,0x9F,0xFC,0x80,0x00,0xFE,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x3F,0xFC,0x80,0x00,0xC0,0x30,0xFF,0xFC,0xC0,0x00,0x00,0x27,0xFF,0xFC,0xC0,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x1F,0xED,0xFF,0xFC,0xF0,0x00,0x1E,0x2F,0xFF,0xB4,0xF8,0x00,0x42,0x05,0xFE,0x4C,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFC,0x40,0x3C,0x00,0xF8,0x1C,0xFF,0xF0,0x78,0x00,0x78,0x1C,0xFF,0xF2,0x78,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x78,0xBC,0xFF,0xF0,0xF0,0x00,0x3C,0xBC,0xFF,0xE3,0xE0,0x00,0x3F,0x9C,0xFF,0xEB,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xC0,0x00,0x1F,0xFC,0xFF,0xE7,0x80,0x00,0x1F,0xFC,0xFF,0xDF,0x00,0x00,0x1F,0xFC,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFF,0x5C,0x00,0x00,0x1F,0xFC,0xFF,0x70,0x00,0x00,0x1F,0xFC,0xFE,0xC4,0x00,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x1F,0xFC,0xFE,0x90,0x00,0x00,0x1F,0xFC,0xFC,0x60,0x00,0x00,0x0F,0xFC,0xFC,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x00,0x1B,0xFC,0xFC,0x00,0x00,0x00,0x13,0xFC,0xF8,0x00,0x00,0x00,0x13,0xFC,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xF8,0x00,0x00,0x00,0x01,0xFC,0xF8,0x00,0x00,0x00,0x00,0xFC,0xF8,0x00,0x00,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0xFC,0xF8,0x00,0x00,0x00,0x00,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFC,0xFC,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x00,0x00,0xFC,0xFE,0x00,0x00,0x00,0x00,0xFC,0xFE,0x00,0x00,0x00,0x00,0xFC,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0xFE,0x00,0x00,0x00,0x01,0xFC,0xFF,0x00,0x00,0x00,0x01,0xFC,0xFF,0x00,0x00,0x00,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x03,0xFC,0xFF,0x00,0x00,0x00,0x03,0xFC,0xFF,0x00,0x00,0x00,0x07,0xFC,0xFF,0x80,</span></span>
<span class="line"><span style="color:#e1e4e8;">	0x00,0x00,0x07,0xFC,</span></span>
<span class="line"><span style="color:#e1e4e8;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">static const unsigned char PROGMEM boy[] = {</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0x0F,0xFF,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xF0,0xFF,0xFF,0xFE,0x01,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFE,0x3F,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0x01,0xFF,0xF0,0xFF,0xFF,0xFE,0x3B,0xFF,0xF8,0x03,0x87,0xF0,0xFD,0xFF,0xFE,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xC0,0x01,0xCF,0xF0,0xFF,0xFF,0xFC,0xF8,0xFC,0x00,0x07,0xFF,0xF0,0xEE,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xC0,0xE0,0x00,0x7F,0xFF,0xF0,0xF0,0xE9,0xFF,0xF0,0x00,0x01,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xF0,0xFC,0xE3,0xFF,0xC0,0x00,0x01,0xFF,0xFF,0xF0,0xFD,0x2F,0xFF,0x80,0x00,0x03,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xF0,0xFC,0x10,0xFF,0xE0,0x00,0x07,0xFF,0xFF,0xF0,0xFE,0x2D,0xFF,0x80,</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x0F,0xFF,0xFF,0xF0,0xFF,0x65,0xFF,0xC0,0x00,0x1F,0xFF,0xFF,0xF0,0xFD,0xE7,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xC0,0x00,0x3F,0xFF,0xFF,0xF0,0xFF,0x83,0xFF,0x80,0x00,0x3F,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0x97,0xFF,0x00,0x00,0x3F,0xFF,0xFF,0xF0,0xFF,0x8F,0xFE,0x00,0x00,0x3F,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xF0,0xFF,0xDF,0xFE,0x70,0x00,0x3F,0xFF,0xFF,0xF0,0xFD,0xFF,0xEF,0xF8,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x3F,0xFF,0xFF,0xF0,0xFD,0xFF,0xFB,0xFC,0x00,0x1F,0xFF,0xFF,0xF0,0xFD,0xBF,0xA1,</span></span>
<span class="line"><span style="color:#24292e;">	0xC4,0x00,0x1F,0xFF,0xFF,0xF0,0xFD,0xBF,0xF0,0xF0,0x00,0x1F,0xFF,0xFF,0xF0,0xFD,</span></span>
<span class="line"><span style="color:#24292e;">	0x9F,0xF0,0x00,0x00,0x1F,0xFF,0xFF,0xF0,0xFF,0x03,0xD0,0x00,0x00,0x0F,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xF0,0xFF,0x01,0x62,0x00,0x00,0x0F,0xFF,0xFF,0xF0,0xFF,0x80,0x07,0x00,0x00,0x07,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xF0,0xFF,0xC0,0x0F,0x00,0x00,0x03,0xFF,0xFF,0xF0,0xFB,0xE0,0x3F,0x80,</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x03,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xC0,0x00,0x01,0xFF,0xFF,0xF0,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xC0,0x00,0x03,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xC0,0x00,0x03,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xFF,0xC0,0x00,0x01,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xE0,0x00,0x01,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xF0,0xFF,0xFF,0xFF,0xE1,0xFE,0x00,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xE7,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xC0,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xEF,0xFF,0xF8,0x7F,0xFF,0xF0,0xFF,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xDF,0xF3,0xFC,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xC8,0x3F,0xFF,0xFF,0xF0,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xFF,0xF0,0x7F,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0x87,0x2F,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xF0,0xFF,0xFF,0xFF,0xFF,0xCF,0xBF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0x1F,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xEF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFE,0x3F,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFC,</span></span>
<span class="line"><span style="color:#24292e;">	0x7F,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xF8,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xF1,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xE3,0xFF,0xFF,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xFF,0x87,0xFF,0xFE,0xFF,0xFF,0xF0,0xFF,0xFF,0xFE,0x0F,0xFF,0xFF,0xFD,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xF0,0xFF,0xFF,0xFC,0x1F,0xFF,0xFF,0x71,0xFF,0xF0,0xFF,0xFF,0xF8,0x3F,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xD1,0xFF,0xF0,0xFF,0xFF,0xF0,0x3F,0xFF,0xFF,0xF9,0xFF,0xF0,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#24292e;">	0x7F,0xFF,0xFF,0xF9,0xFF,0xF0,0xFF,0xFF,0xE9,0xFF,0xFF,0xFF,0xF9,0xFF,0xF0,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xF9,0xFF,0xFF,0xFF,0xF8,0xFF,0xF0,0xFF,0xFF,0xF3,0xFF,0xFF,0xFF,0xFC,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xF0,0xFF,0xFF,0xC7,0xFF,0xFF,0xFF,0xFC,0x7F,0xF0,0xFF,0xFD,0x8F,0xFF,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFC,0xFF,0xF0,0xFF,0xFD,0x0F,0xFF,0xFF,0xFF,0xEC,0xFF,0xF0,0xFF,0xF8,0x7F,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xFC,0xFF,0xF0,0xFF,0xFC,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xF0,0xFF,0xF8,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xFF,0xFF,0xF0,0x7F,0xF0,0xFF,0xFC,0xFF,0xFF,0xFF,0xFF,0xF0,0x7F,0xF0,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xF7,0xBF,0xF0,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xF7,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xF0,0xFF,0x00,0x7F,0xFF,0xFF,0xFF,0xF7,0x9F,0xF0,0xFF,0x00,0x00,0x00,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x01,0xFB,0x80,0x30,0xFF,0xFF,0xFF,0xFF,0x1F,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,</span></span>
<span class="line"><span style="color:#24292e;">};</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">static const unsigned char PROGMEM girl[] = {</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFF,0xFC,0x01,0xFF,0xFF,0xFC,0xFF,0xC0,0x00,0x7F,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0xFC,0xFF,0x80,0x00,0x1F,0xFF,0xFC,0xFE,0x00,0x00,0x0F,0xFF,0xFC,0xFE,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x03,0xFF,0xFC,0xFC,0x00,0x00,0x01,0xFF,0xFC,0xF8,0x00,0x00,0x01,0xFF,0xFC,</span></span>
<span class="line"><span style="color:#24292e;">	0xF8,0x00,0x00,0x00,0xFF,0xFC,0xF0,0x00,0x00,0x00,0xFF,0xFC,0xF8,0x00,0x00,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x7F,0xFC,0xF8,0x00,0x00,0x00,0x7F,0xFC,0xE0,0x00,0x00,0x00,0x7F,0xFC,0xE0,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x00,0xFF,0xFC,0xF0,0x00,0x00,0x00,0x7F,0xFC,0xF0,0x00,0x08,0x00,0x3F,0xFC,</span></span>
<span class="line"><span style="color:#24292e;">	0xF0,0x00,0x18,0x00,0x3F,0xFC,0xE0,0x00,0x10,0x0F,0x3F,0xFC,0xE0,0x00,0x34,0x7F,</span></span>
<span class="line"><span style="color:#24292e;">	0x3F,0xFC,0xE0,0x00,0x3F,0xFF,0x3F,0xFC,0xE0,0x00,0x3F,0x0F,0xBF,0xFC,0xE0,0x10,</span></span>
<span class="line"><span style="color:#24292e;">	0x3F,0xFF,0x9F,0xFC,0xE0,0x30,0x3F,0xFF,0xDF,0xFC,0xE0,0x38,0x7F,0xFF,0xDF,0xFC,</span></span>
<span class="line"><span style="color:#24292e;">	0xC0,0x3C,0x7F,0xFF,0xFF,0xFC,0xC0,0x3C,0x7F,0xFF,0x9F,0xFC,0xC0,0x1C,0x7F,0xFF,</span></span>
<span class="line"><span style="color:#24292e;">	0x9F,0xFC,0xC0,0x04,0x3F,0xFC,0x1F,0xFC,0xC0,0x00,0x3F,0xFF,0x1F,0xFC,0xC0,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x7F,0xFF,0x1F,0xFC,0xC0,0x00,0x7F,0xFF,0x1F,0xFC,0x80,0x00,0x7F,0xFF,0x1F,0xFC,</span></span>
<span class="line"><span style="color:#24292e;">	0x80,0x00,0x7C,0x7E,0x1F,0xFC,0x80,0x00,0x7E,0x00,0x9F,0xFC,0x80,0x00,0xFE,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x3F,0xFC,0x80,0x00,0xC0,0x30,0xFF,0xFC,0xC0,0x00,0x00,0x27,0xFF,0xFC,0xC0,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x1F,0xED,0xFF,0xFC,0xF0,0x00,0x1E,0x2F,0xFF,0xB4,0xF8,0x00,0x42,0x05,0xFE,0x4C,</span></span>
<span class="line"><span style="color:#24292e;">	0xFC,0x40,0x3C,0x00,0xF8,0x1C,0xFF,0xF0,0x78,0x00,0x78,0x1C,0xFF,0xF2,0x78,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x78,0xBC,0xFF,0xF0,0xF0,0x00,0x3C,0xBC,0xFF,0xE3,0xE0,0x00,0x3F,0x9C,0xFF,0xEB,</span></span>
<span class="line"><span style="color:#24292e;">	0xC0,0x00,0x1F,0xFC,0xFF,0xE7,0x80,0x00,0x1F,0xFC,0xFF,0xDF,0x00,0x00,0x1F,0xFC,</span></span>
<span class="line"><span style="color:#24292e;">	0xFF,0x5C,0x00,0x00,0x1F,0xFC,0xFF,0x70,0x00,0x00,0x1F,0xFC,0xFE,0xC4,0x00,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x1F,0xFC,0xFE,0x90,0x00,0x00,0x1F,0xFC,0xFC,0x60,0x00,0x00,0x0F,0xFC,0xFC,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x00,0x1B,0xFC,0xFC,0x00,0x00,0x00,0x13,0xFC,0xF8,0x00,0x00,0x00,0x13,0xFC,</span></span>
<span class="line"><span style="color:#24292e;">	0xF8,0x00,0x00,0x00,0x01,0xFC,0xF8,0x00,0x00,0x00,0x00,0xFC,0xF8,0x00,0x00,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0xFC,0xF8,0x00,0x00,0x00,0x00,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFC,0xFC,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x00,0x00,0xFC,0xFE,0x00,0x00,0x00,0x00,0xFC,0xFE,0x00,0x00,0x00,0x00,0xFC,</span></span>
<span class="line"><span style="color:#24292e;">	0xFE,0x00,0x00,0x00,0x01,0xFC,0xFF,0x00,0x00,0x00,0x01,0xFC,0xFF,0x00,0x00,0x00,</span></span>
<span class="line"><span style="color:#24292e;">	0x03,0xFC,0xFF,0x00,0x00,0x00,0x03,0xFC,0xFF,0x00,0x00,0x00,0x07,0xFC,0xFF,0x80,</span></span>
<span class="line"><span style="color:#24292e;">	0x00,0x00,0x07,0xFC,</span></span>
<span class="line"><span style="color:#24292e;">};</span></span></code></pre></div><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;SPI.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载SPI库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Wire.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Wire库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Adafruit_GFX.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Adafruit_GFX库</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;Adafruit_SSD1306.h&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 加载Adafruit_SSD1306库</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;image.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 定义 OLED屏幕的分辨率</span></span>
<span class="line"><span style="color:#E1E4E8;">Adafruit_SSD1306 display </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Adafruit_SSD1306</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">128</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">64</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#FFAB70;">Wire</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">115200</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#E1E4E8;">  display.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">3C</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">image_display</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">image_display</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 显示之前清屏</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">clearDisplay</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//1,2为显示起始位置,左上角为坐标原点</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//3位置为图形数组</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//4,5为图像宽度和高度(错误不会显示原像)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//6 颜色</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">drawBitmap</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,boy, </span><span style="color:#79B8FF;">72</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">70</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">drawBitmap</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">75</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,girl, </span><span style="color:#79B8FF;">48</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">70</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//显示图形</span></span>
<span class="line"><span style="color:#E1E4E8;">    display.</span><span style="color:#B392F0;">display</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;SPI.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载SPI库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Wire.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Wire库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Adafruit_GFX.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Adafruit_GFX库</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;Adafruit_SSD1306.h&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 加载Adafruit_SSD1306库</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;image.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 定义 OLED屏幕的分辨率</span></span>
<span class="line"><span style="color:#24292E;">Adafruit_SSD1306 display </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Adafruit_SSD1306</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">128</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">64</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#E36209;">Wire</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">115200</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置串口波特率</span></span>
<span class="line"><span style="color:#24292E;">  display.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(SSD1306_SWITCHCAPVCC, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">3C</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // 设置OLED的I2C地址</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">image_display</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">image_display</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 显示之前清屏</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">clearDisplay</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//1,2为显示起始位置,左上角为坐标原点</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//3位置为图形数组</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//4,5为图像宽度和高度(错误不会显示原像)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//6 颜色</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">drawBitmap</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,boy, </span><span style="color:#005CC5;">72</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">70</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">drawBitmap</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">75</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,girl, </span><span style="color:#005CC5;">48</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">70</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//显示图形</span></span>
<span class="line"><span style="color:#24292E;">    display.</span><span style="color:#6F42C1;">display</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_9-蜂鸣器使用-学习来自博客" tabindex="-1">9.蜂鸣器使用(学习来自<a href="https://blog.csdn.net/freewebsys/article/details/104586650/" target="_blank" rel="noreferrer">博客</a>) <a class="header-anchor" href="#_9-蜂鸣器使用-学习来自博客" aria-label="Permalink to &quot;9.蜂鸣器使用(学习来自[博客](https://blog.csdn.net/freewebsys/article/details/104586650/))&quot;">​</a></h5><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTD0</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// low</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDL1</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">262</span><span style="color:#6A737D;"> // NOTE_C4  262  L1</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDL2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">294</span><span style="color:#6A737D;"> // NOTE_D4  294  L2</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDL3</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">330</span><span style="color:#6A737D;"> // NOTE_E4  330  L3</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDL4</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">349</span><span style="color:#6A737D;"> // NOTE_F4  349  L4</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDL5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">392</span><span style="color:#6A737D;"> // NOTE_G4  392  L5</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDL6</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">440</span><span style="color:#6A737D;"> // NOTE_A4  440  L6</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDL7</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">494</span><span style="color:#6A737D;"> // NOTE_B4  494  L7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTD1</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">523</span><span style="color:#6A737D;"> // NOTE_C5  523   1</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTD2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">587</span><span style="color:#6A737D;"> // NOTE_D5  587   2</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTD3</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">659</span><span style="color:#6A737D;"> // NOTE_E5  659   3</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTD4</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">698</span><span style="color:#6A737D;"> // NOTE_F5  698   4</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTD5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">784</span><span style="color:#6A737D;"> // NOTE_G5  784   5</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTD6</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">880</span><span style="color:#6A737D;"> // NOTE_A5  880   6</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTD7</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">988</span><span style="color:#6A737D;"> // NOTE_B5  988   7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// high </span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDH1</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1047</span><span style="color:#6A737D;"> // NOTE_C6  1047  H1</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDH2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1175</span><span style="color:#6A737D;"> // NOTE_D6  1175  H2</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDH3</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1319</span><span style="color:#6A737D;"> // NOTE_E6  1319  H3</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDH4</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1397</span><span style="color:#6A737D;"> // NOTE_F6  1397  H4</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDH5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1568</span><span style="color:#6A737D;"> // NOTE_G6  1568  H5</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDH6</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1760</span><span style="color:#6A737D;"> // NOTE_A6  1760  H6</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NTDH7</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1976</span><span style="color:#6A737D;"> // NOTE_B6  1976  H7</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// notes in the melody:</span></span>
<span class="line"><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> melody</span><span style="color:#F97583;">[]</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  NTD3,NTD2,NTD2,NTD1,NTD1,NTD2,NTD1,NTD2,NTD1,NTD2,NTD5,NTD6,NTD5,NTD5,</span></span>
<span class="line"><span style="color:#E1E4E8;">  NTD0,NTD3,NTDH1,NTDH1,NTD7,NTD7,NTD6,NTD5,NTD5,NTD3,NTD3,NTD5,NTD6,NTD5,NTD5,</span></span>
<span class="line"><span style="color:#E1E4E8;">  NTD0,NTD5,NTD6,NTD6,NTD6,NTD6,NTD6,NTD5,NTD5,NTD1,NTD1,NTD1,NTD2,NTD3,NTD0,</span></span>
<span class="line"><span style="color:#E1E4E8;">  NTDL5,NTDL5,NTD3,NTD2,NTD0,NTD1,NTD1,NTD1,NTD1,NTDL6,NTDL6,NTD2,</span></span>
<span class="line"><span style="color:#E1E4E8;">  NTD0,NTD3,NTD2,NTD2,NTD1,NTD1,NTD2,NTD1,NTD2,NTD1,NTD2,NTD5,NTD6,NTD5,NTD5,</span></span>
<span class="line"><span style="color:#E1E4E8;">  NTD0,NTD3,NTDH1,NTDH1,NTD7,NTD7,NTD6,NTD5,NTD5,NTD3,NTD3,NTD5,NTD6,NTD5,NTD5,</span></span>
<span class="line"><span style="color:#E1E4E8;">  NTD0,NTD5,NTD6,NTD6,NTD6,NTD6,NTD6,NTD5,NTD5,NTD1,NTD1,NTD1,NTD2,NTD3,NTD0,</span></span>
<span class="line"><span style="color:#E1E4E8;">  NTDL5,NTDL5,NTD3,NTD2,NTD0,NTD2,NTD2,NTD3,NTD4,NTD5,NTD5,NTD2,</span></span>
<span class="line"><span style="color:#E1E4E8;">  NTD3,NTDL6,NTD2,NTD1,NTD0,NTD0,NTD2,NTD1,NTD0,NTD0,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// note durations: 4 = quarter note, 8 = eighth note, etc.:</span></span>
<span class="line"><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> noteDurations</span><span style="color:#F97583;">[]</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">12</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//针脚，GPIO后面的数字即是针脚数</span></span>
<span class="line"><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> tonepin</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">common_play</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">//主要是 tone()函数，第一个参数是针脚数，第二个参数是设置电位强弱，第三个参数是持续时间</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> thisNote </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; thisNote </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">sizeof</span><span style="color:#E1E4E8;">(melody)</span><span style="color:#F97583;">/</span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">; thisNote</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//节拍设置为8拍</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> noteDuration </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> ( </span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;"> ) </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">noteDurations</span><span style="color:#E1E4E8;">[thisNote];</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">tone</span><span style="color:#E1E4E8;">(tonepin, </span><span style="color:#FFAB70;">melody</span><span style="color:#E1E4E8;">[thisNote], noteDuration);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(noteDuration);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// stop the tone playing:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">noTone</span><span style="color:#E1E4E8;">(tonepin);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  Serial.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">9600</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot; init ...&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">sizeof</span><span style="color:#E1E4E8;">(melody));</span></span>
<span class="line"><span style="color:#E1E4E8;">  Serial.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">sizeof</span><span style="color:#E1E4E8;">(noteDurations));</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">//将该针脚作为输出</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">pinMode</span><span style="color:#E1E4E8;">(tonepin,OUTPUT);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loop</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">common_play</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;">//Play the music.</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">delay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">3000</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;">//Pause for a while.</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTD0</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// low</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDL1</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">262</span><span style="color:#6A737D;"> // NOTE_C4  262  L1</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDL2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">294</span><span style="color:#6A737D;"> // NOTE_D4  294  L2</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDL3</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">330</span><span style="color:#6A737D;"> // NOTE_E4  330  L3</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDL4</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">349</span><span style="color:#6A737D;"> // NOTE_F4  349  L4</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDL5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">392</span><span style="color:#6A737D;"> // NOTE_G4  392  L5</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDL6</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">440</span><span style="color:#6A737D;"> // NOTE_A4  440  L6</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDL7</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">494</span><span style="color:#6A737D;"> // NOTE_B4  494  L7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTD1</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">523</span><span style="color:#6A737D;"> // NOTE_C5  523   1</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTD2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">587</span><span style="color:#6A737D;"> // NOTE_D5  587   2</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTD3</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">659</span><span style="color:#6A737D;"> // NOTE_E5  659   3</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTD4</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">698</span><span style="color:#6A737D;"> // NOTE_F5  698   4</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTD5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">784</span><span style="color:#6A737D;"> // NOTE_G5  784   5</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTD6</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">880</span><span style="color:#6A737D;"> // NOTE_A5  880   6</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTD7</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">988</span><span style="color:#6A737D;"> // NOTE_B5  988   7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// high </span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDH1</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1047</span><span style="color:#6A737D;"> // NOTE_C6  1047  H1</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDH2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1175</span><span style="color:#6A737D;"> // NOTE_D6  1175  H2</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDH3</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1319</span><span style="color:#6A737D;"> // NOTE_E6  1319  H3</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDH4</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1397</span><span style="color:#6A737D;"> // NOTE_F6  1397  H4</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDH5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1568</span><span style="color:#6A737D;"> // NOTE_G6  1568  H5</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDH6</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1760</span><span style="color:#6A737D;"> // NOTE_A6  1760  H6</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NTDH7</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1976</span><span style="color:#6A737D;"> // NOTE_B6  1976  H7</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// notes in the melody:</span></span>
<span class="line"><span style="color:#D73A49;">int</span><span style="color:#24292E;"> melody</span><span style="color:#D73A49;">[]</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  NTD3,NTD2,NTD2,NTD1,NTD1,NTD2,NTD1,NTD2,NTD1,NTD2,NTD5,NTD6,NTD5,NTD5,</span></span>
<span class="line"><span style="color:#24292E;">  NTD0,NTD3,NTDH1,NTDH1,NTD7,NTD7,NTD6,NTD5,NTD5,NTD3,NTD3,NTD5,NTD6,NTD5,NTD5,</span></span>
<span class="line"><span style="color:#24292E;">  NTD0,NTD5,NTD6,NTD6,NTD6,NTD6,NTD6,NTD5,NTD5,NTD1,NTD1,NTD1,NTD2,NTD3,NTD0,</span></span>
<span class="line"><span style="color:#24292E;">  NTDL5,NTDL5,NTD3,NTD2,NTD0,NTD1,NTD1,NTD1,NTD1,NTDL6,NTDL6,NTD2,</span></span>
<span class="line"><span style="color:#24292E;">  NTD0,NTD3,NTD2,NTD2,NTD1,NTD1,NTD2,NTD1,NTD2,NTD1,NTD2,NTD5,NTD6,NTD5,NTD5,</span></span>
<span class="line"><span style="color:#24292E;">  NTD0,NTD3,NTDH1,NTDH1,NTD7,NTD7,NTD6,NTD5,NTD5,NTD3,NTD3,NTD5,NTD6,NTD5,NTD5,</span></span>
<span class="line"><span style="color:#24292E;">  NTD0,NTD5,NTD6,NTD6,NTD6,NTD6,NTD6,NTD5,NTD5,NTD1,NTD1,NTD1,NTD2,NTD3,NTD0,</span></span>
<span class="line"><span style="color:#24292E;">  NTDL5,NTDL5,NTD3,NTD2,NTD0,NTD2,NTD2,NTD3,NTD4,NTD5,NTD5,NTD2,</span></span>
<span class="line"><span style="color:#24292E;">  NTD3,NTDL6,NTD2,NTD1,NTD0,NTD0,NTD2,NTD1,NTD0,NTD0,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// note durations: 4 = quarter note, 8 = eighth note, etc.:</span></span>
<span class="line"><span style="color:#D73A49;">int</span><span style="color:#24292E;"> noteDurations</span><span style="color:#D73A49;">[]</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">12</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//针脚，GPIO后面的数字即是针脚数</span></span>
<span class="line"><span style="color:#D73A49;">int</span><span style="color:#24292E;"> tonepin</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">4</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">common_play</span><span style="color:#24292E;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">//主要是 tone()函数，第一个参数是针脚数，第二个参数是设置电位强弱，第三个参数是持续时间</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> thisNote </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; thisNote </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">sizeof</span><span style="color:#24292E;">(melody)</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">4</span><span style="color:#24292E;">; thisNote</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//节拍设置为8拍</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> noteDuration </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ( </span><span style="color:#005CC5;">1000</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">8</span><span style="color:#24292E;"> ) </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#E36209;">noteDurations</span><span style="color:#24292E;">[thisNote];</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">tone</span><span style="color:#24292E;">(tonepin, </span><span style="color:#E36209;">melody</span><span style="color:#24292E;">[thisNote], noteDuration);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(noteDuration);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// stop the tone playing:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">noTone</span><span style="color:#24292E;">(tonepin);</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  Serial.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9600</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot; init ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">sizeof</span><span style="color:#24292E;">(melody));</span></span>
<span class="line"><span style="color:#24292E;">  Serial.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">sizeof</span><span style="color:#24292E;">(noteDurations));</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">//将该针脚作为输出</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">pinMode</span><span style="color:#24292E;">(tonepin,OUTPUT);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">common_play</span><span style="color:#24292E;">();</span><span style="color:#6A737D;">//Play the music.</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">delay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">3000</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">//Pause for a while.</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div>`,35),e=[o];function t(c,r,E,y,F,i){return n(),a("div",null,e)}const D=s(p,[["render",t]]);export{C as __pageData,D as default};
